<!DOCTYPE html>
<html>

<head>
  <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
  <base href="/">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="A new Flutter project.">

  <!-- CORS and security headers -->
  <meta http-equiv="Access-Control-Allow-Origin" content="*">
  <meta http-equiv="Access-Control-Allow-Methods" content="GET, POST, PUT, DELETE, OPTIONS">
  <meta http-equiv="Access-Control-Allow-Headers" content="Content-Type, Authorization, X-Requested-With">

  <!-- iOS meta tags & icons -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="flutter_simple">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png" />

  <title>Xintel</title>
  <link rel="manifest" href="manifest.json">

  <!-- CORS Anywhere proxy script -->
  <script>
    // Override fetch to use CORS Anywhere proxy
    const originalFetch = window.fetch;
    window.fetch = function (url, options) {
      // Only proxy requests to your backend
      if (typeof url === 'string' &&
        (url.includes('backend.educhain.tech') ||
          url.includes('chat.educhain.tech') ||
          url.includes('hasura.educhain.tech'))) {

        console.log('Proxying request to:', url);
        // Use CORS Anywhere public proxy
        const proxyUrl = 'https://cors-anywhere.herokuapp.com/';

        // Create new options with CORS headers
        const newOptions = options || {};
        newOptions.headers = newOptions.headers || {};
        newOptions.headers['X-Requested-With'] = 'XMLHttpRequest';

        return originalFetch(proxyUrl + url, newOptions);
      }

      // For all other requests, use original fetch
      return originalFetch(url, options);
    };
  </script>

  <style>
    /* Ngăn chặn context menu và selection */
    body {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    /* Tắt spell check và dấu gạch chân cho tất cả input và textarea */
    input,
    textarea,
    [contenteditable] {
      -webkit-spellcheck: false !important;
      -moz-spellcheck: false !important;
      spellcheck: false !important;
      text-decoration: none !important;
      -webkit-text-decoration-line: none !important;
      text-decoration-line: none !important;
    }

    /* Loại bỏ dấu gạch chân spell check trong Flutter web */
    flt-text-editing-host input,
    flt-text-editing-host textarea {
      -webkit-spellcheck: false !important;
      -moz-spellcheck: false !important;
      spellcheck: false !important;
      text-decoration: none !important;
      -webkit-text-decoration: none !important;
      -webkit-text-decoration-line: none !important;
      text-decoration-line: none !important;
    }

    /* Loại bỏ outline khi focus */
    flt-text-editing-host input:focus,
    flt-text-editing-host textarea:focus {
      outline: none !important;
      -webkit-text-decoration: none !important;
      text-decoration: none !important;
    }
  </style>
</head>

<body>
  <script>
    // Ngăn chặn context menu mặc định
    document.addEventListener('contextmenu', function (e) {
      e.preventDefault();
      return false;
    });

    // Ngăn chặn drag and drop
    document.addEventListener('dragstart', function (e) {
      e.preventDefault();
      return false;
    });

    // Ngăn chặn select text
    document.addEventListener('selectstart', function (e) {
      e.preventDefault();
      return false;
    });
  </script>

  <script src="flutter_bootstrap.js" async></script>
</body>

</html>